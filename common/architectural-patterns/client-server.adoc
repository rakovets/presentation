= Architectural pattern: Client-Server
:imagesdir: ../../assets/img/common/architectural-patterns/client-server

== Architectural pattern: Client-Server

=== Intro

[.step]
* Основная идея *клиент-сервер* состоит в *разделении сетевого приложения* на несколько компонентов, каждый из которых реализует специфический набор сервисов и обеспечивает совместный доступ к одной и той же информации из разных мест одновременно.
* Компоненты такого приложения могут выполняться на разных вычислительных системах, выполняя серверные и/или клиентские функции. Это позволяет повысить надежность, безопасность и производительность сетевых приложений и сети в целом.

== Типы серверов

=== Web-серверы

[.step]
* Изначально представляли доступ к гипертекстовым документам по протоколу *HTTP* (*HyperText Transfer Protocol*).
* Сейчас поддерживают расширенные возможности, в частности работу с бинарными файлами: изображения, мультимедиа и т.п.
* Например:
[.step]
** *nginx* свободный веб-сервер
** *Apache HTTP Server* свободный веб-сервер
** *Apache Tomcat* свободный веб-сервер
** *IIS* от компании _Microsoft_

=== Серверы приложений

[.step]
* Предназначены для централизованного решения прикладных задач в некоторой предметной области.
* Для этого пользователи имеют право запускать серверные программы на исполнение.
* Использование серверов приложений позволяет снизить требования к конфигурации клиентов и упрощает общее управление сетью.

=== Серверы баз данных

[.step]
* *Серверы баз данных* используются для обработки пользовательских запросов на языке *SQL*.
* При этом *СУБД* находится на сервере, к которому и подключаются клиентские приложения.

=== Файл-серверы

[.step]
* *Файл-сервер* хранит информацию в виде файлов и представляет пользователям доступ к ней.
* Как правило, *файл-сервер* обеспечивает и определенный уровень защиты от несанкционированного доступа.

=== Почтовые серверы

[.step]
* Представляют услуги по отправке и получению электронных почтовых сообщений.

=== Серверы сообщений

[.step]
* Представляют услуги по отправке и получению мгновенных сообщений.

== Двухуровневая архитектура

=== Двухуровневая с одним сервером

[.fragment]
image:two-tier-arch-with-one-server.png[Двухуровневая с одним сервером]

=== Двухуровневая с несколькими серверами

[.fragment]
image:two-tier-arch-with-n-server.png[Двухуровневая с несколькими серверами]

=== Двухуровневая архитектура

[.step]
* *Двухуровневая архитектура* используется в *клиент-серверных системах*, где *сервер* отвечает на клиентские запросы напрямую и в полном объеме, при этом используя только собственные ресурсы.
* Т.е. сервер не вызывает сторонние сетевые приложения и не обращается к сторонним ресурсам для выполнения какой-либо части запроса.
* Типичным сервером для двухуровневой архитектуры является *сервер БД*.

== Трехуровневая архитектура

=== Трехуровневая архитектура

[.fragment]
image:three-tier-arch.png[Трехуровневая архитектура]

=== Трехуровневая архитектура

[.step]
* *Представление данных* — на стороне клиента.
* *Прикладной компонент* — на выделенном сервере приложений (как вариант, выполняющем функции промежуточного ПО).
* *Управление ресурсами* — на сервере БД, который и представляет запрашиваемые данные.

== Многоуровневая (N-tier) архитектура

=== Многоуровневая (N-tier) архитектура

[.fragment]
image:n-tier-arch.png[Многоуровневая (N-tier) архитектура]

=== Многоуровневая (N-tier) архитектура

[.step]
* Серверами 2-го уровня, как правило, являются балансировщики, диспетчеры, шлюзы различных видов и т.п.
* На 3-м и последующих уровнях, как правило, располагаются *сервера приложений*, *web-сервера* и т.п.
* Последний уровень, как правило, различные сервера-поставщики данных (БД, web-сервисами и т.п.)

== Сравнение архитектур

=== Двухуровневая архитектура

[.step]
* Двухуровневая архитектура *проще*, так как:
[.step]
** клиент эксплуатируется на мощной рабочей станции и разрабатывается с использованием мощных средств разработки
** все запросы обслуживаются одним сервером БД
* *Менее надежна и предъявляет повышенные требования* к производительности сервера.

=== Трехуровневая архитектура

[.step]
* Трехуровневая архитектура *сложнее* как в разработке, так и эксплуатации.

=== Трехуровневая архитектура

[.step]
* Эта архитектура представляет:
[.step]
** *Высокую производительность* (т.к. ресурсы серверов динамически распределяются между клиентами)
** *Высокую безопасность* (т.к. защиту можно определить для каждого сервиса или уровня)
** *Высокую степень надежности* (т.к. код и данные объединены)
** *Высокую степень гибкости*
** *Высокую степень масштабируемости*
** *Централизованное управление*

=== Проблемы архитектуры клиент-сервер

[.step]
* *Централизация*
[.step]
** «падение» сервера приведет к недоступности программ для всех клиентов.
* *Защита информации*
[.step]
** актуальна для любых сетевых решений, использующих инфраструктуру публичных сетей.

== Проблемы архитектуры клиент-сервер

[.step]
* *Стоимость разработки и обслуживания*
[.step]
** ощутимо выше стоимости разработки монолитного приложения.
* *Производительность*
[.step]
** зависит от производительности серверной части, что требует значительных затрат на «железо»

== Тонкий и толстый клиент

=== Модели клиент-серверного взаимодействия

[.fragment]
Расположение компонентов на стороне клиента или сервера определяет следующие основные модели их взаимодействия в рамках двухуровневой архитектуры:

[.step]
* *сервер терминалов* — распределенное представление данных;
* *файл-сервер* — доступ к удаленной базе данных и файловым ресурсам;
* *сервер БД* — удаленное представление данных;
* *сервер приложений* — удаленное приложение.

=== Модели клиент-серверного взаимодействия

[.fragment]
image:client-server-models.png[Модели клиент-серверного взаимодействия]

=== Тонкий клиент

[.step]
* Этот термин определяет клиента, вычислительных ресурсов которого достаточно лишь для запуска необходимого сетевого приложения через web-интерфейс.
* Пользовательский интерфейс такого приложения формируется, например, средствами HTML и вся прикладная логика выполняется на сервере.
* Для работы тонкого клиента достаточно лишь обеспечить возможность запуска web-браузера, в окне которого и осуществляются все действия.
* По этой причине web-браузер часто называют "универсальным клиентом".

=== Толстый клиент

[.step]
* Программно-аппаратной платформой такого клиента является рабочая станция или персональный компьютер, работающие под управлением собственной дисковой операционной системы и имеющие необходимый набор программного обеспечения.
* Непосредственно же под *толстым* клиентом подразумевается клиентское сетевое приложение, запущенное под управлением локальной ОС.
* Такое приложение совмещает компонент представления данных и компонент прикладной логики.

== Серверы приложений

=== Серверы приложений

[.step]
* *Сервер приложений* — это сервисная программа, которая обеспечивает доступ клиентов к прикладным программам, выполняющимся на сервере.
* Сервер приложений обычно выделяется как среднее звено в трехуровневой (многоуровневой) клиент-серверной архитектуре
* Сервер приложений предоставляет среду, в которой прикладные программы могут работать, независимо от того, что и как именно они делают.

=== Серверы терминалов

[.step]
* *Серверы терминалов* представляют среду для удаленного выполнения программ, в качестве которой выступает сама операционная система.
* Доступ к ним осуществляется по протоколам удаленного управления (*telnet*, *ssh*, *RDP*, *VNC* и т. п.) из клиентского ПО (*эмулятор терминала*, *средства управления удаленным рабочим столом* и т.п.)

=== Серверы терминалов

[.step]
* Управление запущенной программой выполняется через эмулируемый на клиенте пользовательский интерфейс (текстовый или графический) операционной системы.
* На серверной стороне взаимодействие программ с ОС реализуется через системные вызовы.
* Управление также осуществляется средствами операционной системы.
* Разработка может вестись на любом языке, доступном в конкретной ОС.

=== Общий шлюзовой интерфейс

[.step]
* *Общий шлюзовой интерфейс* (*CGI*) — технология доступа к приложениям через веб-сервер.
* Отличия от сервера терминалов здесь в том, что пользовательский интерфейс предоставляется в виде веб-страниц.
* Запросы веб-клиентов, обращенные к программам, размещенным в выделенном каталоге (как правило `cgi` или `cgi-bin`) перенаправляются на их вход через стандартный поток ввода (*stdin*).
* Результаты выполнения в виде гипертекста приложение возвращает веб-серверу через *stdout*.

=== Серверы Java-приложений

[.step]
* *Контейнер сервлетов* — один из архитектурных компонентов *J2EE*, представляющий окружение для выполнения сервлетов.
* *Сервлет* — это Java-приложение, выполняющееся на стороне сервера (в отличие от апплета).
* *Контейнер сервлетов* может работать как полноценный самостоятельный сервер, но чаще используется совместно с другим серверным ПО.
* Обеспечивает обмен данными между сервлетом и клиентами, берёт на себя выполнение таких функций, как создание программной среды для функционирующего сервлета, идентификацию и авторизацию клиентов, организацию сессии для каждого из них.

=== Серверы Java-приложений

[.step]
* *Сервер приложений J2EE* — реализация системы в соответствии со спецификацией *J2EE*, обеспечивающая работу модулей с логикой конкретного приложения.
* Включает в себя как минимум следующие сервисы:
[.step]
** *EJB-контейнер*, который поддерживает автоматическую синхронизацию Java-объектов с базой данных (*CMP* — container managed persistence, *BMP* — bean managed persistence);
** *JMS* — сервис доставки сообщений между компонентами и серверами;
** *JSF*

=== Серверы Java-приложений

[.step]
* Включает в себя как минимум следующие сервисы:
[.step]
** Управление ресурсами (доступ к СУБД, файловой системе, почтовому серверу и т. д.);
** Безопасность и защита данных;
** Поддержка транзакций (в том числе и распределённых, двухфазных).
** веб-сервер
** сервлет-сервер;
** поддержка веб-сервисов.

=== Другие платформы

[.step]
* Язык *Python*, получивший популярность во многом благодаря _Google_, является основным средством разработки для сервера веб-приложений *Zope*.
* Для сценариев на языке *PHP*, широко используемом для создания веб-сайтов, компания _Zend Technologies_ (разработчик самого языка PHP) создала сервер приложений *Zend Server*.
* Компания _Microsoft_ представляет собственные решения для поддержки бизнес-логики и сервисной инфрастуктуры на основе _ОС Windows Server_ и технологии *.NET Framework*. Основным средством разработки является язык *C#*. В качестве сервера приложений/WEB сервера выступает *IIS*.

== Промежуточное ПО (middleware)

=== Middleware

[.fragment]
image:middleware.png[Middleware]

=== Middleware

[.fragment]
*Промежуточное программное обеспечение* (*middleware*) — это класс программного обеспечения, предназначенного для объединения компонентов распределенного клиент-серверного приложения или целых сетевых приложений в единую информационную систему.

=== Функции middleware

[.step]
* реализация и поддержка выполнения бизнес-логики
* прозрачный доступ к другим сетевым сервисам и приложениям;
* обеспечение независимости функционирования от других сетевых сервисов;
* обеспечение высокой надежности и постоянной готовности.

=== Виды middleware

[.step]
* Программное обеспечение для межпрограммного взаимодействия
* Программное обеспечение доступа к базам данных.

== Middleware для межпрограммного взаимодействия

=== Remote Procedure Call

[.fragment]
image:rpc.png[Remote Procedure Call]

=== Remote Procedure Call

[.step]
* *Remote Procedure Call* - *Вызов удаленных процедур*- *RPC*
* Развитие *RPC* привело к появлению web-сервисов

=== Message-oriented middleware

[.fragment]
image:mom.png[Message-oriented middleware]

=== Message-Oriented Middleware

[.step]
* *Message-Oriented Middleware* - *MOM* - *Сервисы обработки сообщений*
* *надежная доставка сообщений* (*reliable message delivery*) — система *MOM* гарантирует, что в процессе обмена ни одно сообщение не будет утеряно;
* *гарантированная доставка сообщений* (*guaranteed message delivery*) — сообщение доставляется адресату немедленно или через заданный промежуток времени, не превышающий определенного значения (в случае, если сеть в данный момент не доступна);
* *застрахованная доставка сообщений* (*assured message delivery*) — каждое сообщение доставляется один раз.

=== Transaction Processing monitors

[.fragment]
image:transaction-processing-monitors.png[Transaction Processing monitors]

=== Transaction Processing monitors

[.step]
* *Transaction Processing monitors* - *TP-monitors* - *Мониторы обработки транзакций*
* *Атомарность* (*Atomicity*) – операции транзакции образуют неделимый, атомарный блок, который либо выполняется от начала до конца, либо не выполняется вообще. При невозможности выполнения транзакции происходит откат к исходному состоянию;
* *Согласованность* (*Consistency*) – по завершении транзакции все задействованные ресурсы находятся в предопределенном и согласованном состоянии;

=== Transaction Processing monitors

[.step]
* *Изолированность* (*Isolation*) – одновременный доступ транзакций различных приложений к разделяемым ресурсам координируется таким образом, чтобы исключить их влияние друг на друга;
* *Устойчивость* (*Durability*) – независимо от проблем на нижних уровнях (к примеру, обесточивание системы или сбои в оборудовании) изменения, сделанные успешно завершённой транзакцией, должны остаться сохранёнными после возвращения системы в работу

=== Distributed object systems

[.fragment]
image:distributed-object-systems.png[Distributed object systems]

=== Distributed object systems

[.step]
* *Distributed object systems* - *Распределенные объектные системы*
* *CORBA* (*Common Object Request Broker Architecture*, *типовая архитектура брокера объектных запросов*) — открытый стандарт, разработанный группой *Object Management Group* (*OMG*), который определяет интерфейсы между сетевыми объектами, позволяющие им работать совместно.
* *Брокеры объектных запросов* (*object request brokers*, *ORB*), созданные в соответствии с *CORBA*, представляют интерфейсы для разработки объектно-ориентированных систем «клиент-сервер».

=== Distributed object systems

[.step]
* *Microsoft COM* (*Component Object Model*, *компонентная объектная модель*) — это семейство технологий, предназначенных для организации взаимодействия Windows-приложений (см. MSDN: The Component Object Model). В это семейство входят *COM+*, *DCOM* (Distributed COM) и *ActiveX Controls*. _Microsoft_ позиционирует *COM* как платформу для разработки повторно используемых (re-usable) компонентов приложений. В случае *DCOM* — компонентов распределенных клиент-серверных систем.

=== Distributed object systems

[.step]
* *EJB* (*Enterprise JavaBeans*) — технология, разработанная *Sun Microsystems* для корпоративных решений на платформе *Java EE*. Спецификация *EJB* описывает архитектуру серверных компонентов и порядок их использования в клиент-серверных приложениях. Эта технология упрощает разработку распределенных систем на основе Java и обеспечивает наибольшую переносимость Java-приложений.

=== Middleware для доступа к базам данных

[.step]
* Поддержка стандартов языка `SQL`.
* Поддержка встроенного языка хранимых процедур (`PL/SQL`, `T-SQL`).
* Средства *СУБД*, позволяющие выполнять импорт данных из внешних источников.

=== Open DataBase Connectivity

[.fragment]
image:odbc.png[Open DataBase Connectivity]

=== Open DataBase Connectivity

[.fragment]
image:odbc2.png[Open DataBase Connectivity]

=== Open DataBase Connectivity

[.step]
* *Open DataBase Connectivity* - *ODBC* - *открытое соединение с БД*

=== Event-Driven Architecture

[.fragment]
image:eda-rdbms.png[Event-Driven Architecture]

=== Event-Driven Architecture

[.step]
* *Event-Driven Architecture* - *EDA* - *событийно-управляемая архитектура*
* Это концепция управления корпоративной информационной системой на основе событий, возникающих в бизнес-процессе.

=== Distributed Query Broker

[.fragment]
image:dqb.png[Distributed Query Broker]

=== Distributed Query Broker

[.step]
* *Distributed Query Broker* - *DQB* - брокер распределенных запросов
* Децентрализованное (в отличие от *EDA*) решение для доступа к БД на основе *ORB*.
